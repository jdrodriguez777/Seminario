<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3plus/1.9.2/d3plus.full.min.js"></script>


<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="author" content="Jude moon">
    <title>Seminario de Visualización</title>

    <!-- load d3 and dimple libraries -->
    <script src="http://d3js.org/d3.v4.min.js"></script>
    <script src="http://dimplejs.org/dist/dimple.v2.3.0.min.js"></script>

    <!-- add styles to text and graphics -->
    <style>
        h1 {
            background-color: blue;
            color: yellow;
            font-family: Helvetica, sans-serif;
            width: 100%;
            height: 100%;
            text-align: center;
            padding-top: 30px;
        }
        h2 {
            font-size: 1.4em;
            text-transform: uppercase;
            font-family: Helvetica;
            color: #000;
            margin-top: 0;
        }
        h3 {
            font-family: Helvetica, sans-serif;
            text-align: center;
        }
        h4 {
            font-family: Helvetica, sans-serif;
            text-align: left;
        }
        div.text {
            font-family: Helvetica;
            padding: 5px;
            margin: 20px;
            border-radius: 10px;
        }
    </style>
</head>

<body>
    <h1 class="main-title">Seminario de Visualización<br>
    Desempleo en Colombia</h1>
    <h4 class="main-autor">Nombre: Juan David Rodríguez</h4>
    <h4 class="main-url">Url: <a href="https://js-xkpsaq.stackblitz.io">https://js-xkpsaq.stackblitz.io</a></h4>
    <h4 class="main-fuente">Fuente: <a href="https://www.dane.gov.co/">https://www.dane.gov.co/</a></h4>
    <h4 class="main-fecha">Abril de 2019</h4>
    <br>
    <br>

    <!-- add intro text to the page body -->
    <div class="summary">
        <h2 class="text-title">Resumen</h2>
        <div class="text">
El objetivo de este proyecto es determinar si el desempleo en Colombia se ha incrementado en la última década. Para tal fin se descargaron los datos de desempleo de la página del DANE (Departamento Administrativo Nacional de Estadísticas en Colombia).
<br>
<br>

Aproxidamente desde el año 2014 ha habido una migración masiva de venezolanos hacia Colombia debido a la situación económica, social y política del país hermano, como lo muestra el siguiente reportaje:

<h4 class="main-noticia">Artículo: <a href="https://www.eltiempo.com/especiales/migracion-de-venezolanos-en-colombia-cifras-e-historias-de-vida-72946">Venezolanos, la migración más grande en la historia de Colombia</a></h4>


            <div class="metadato  " >
              La audiencia es el público en general, especialmente los colombianos. El objetivo consiste en mostrar varias visualizaciones que nos permitan determinar si desde el año 2014 se ha incrementado el desempleo en Colombia.
              

            </div>
            </br>
        </div>
    </div>

<h4 class="def">Fuerza laboral: </h4>
    <div class="text">Está conformada por las personas en edad de trabajar que trabajan o están
buscando empleo.</div>

<h4 class="def">Tasa de desempleo: </h4>
    <div class="text">Es la relación porcentual entre el número de personas que están buscando trabajo, y el número de personas que
    integran la fuerza laboral.</div>

<h4 class="def">¿Quiénes son los ocupados?</h4>
    <div class="text">Son las personas que durante el período de referencia se encontraban en una de las siguientes situaciones:<br><br>
1. Trabajó por lo menos una hora remunerada en dinero o en especie en la semana de referencia.<br>
2. Los que no trabajaron la semana de referencia, pero tenían un trabajo.<br>
3. Trabajadores familiares sin remuneración que trabajaron en la semana de referencia por lo menos 1 hora.</div>

<h4 class="def">Tasa de ocupación: </h4>
    <div class="text"> Es la relación porcentual entre la población ocupada y el número de personas que integran la población en edad de
trabajar.</div> </br>

<h2 class="text-title">Tasa de desempleo</h2>
        <div class="text">
        Debido a la situación interna del país, principalmente por la guerra con los carteles del narcotráfico y además el conflicto armado entre guerrillas y el ejército, la tasa de desempleo finalizando los años 90's estaba muy elevada. Los siguientes años la situación empieza a mejorar un poco gracias a nuevas políticas aplicadas en esa época.
        </div>

<h4 class="def">Gráfica de Tasa de Desempleo Nacional mensual desde el año 2001 hasta principios de 2019 </h4>
<div class="text"> Puede seleccionar una región de la gráfica para hacer zoom en ella. Para retornar a la vista global haga doble-click.</div>
<!-- Code from d3-graph-gallery.com -->
<!DOCTYPE html>
<meta charset="utf-8">

<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.js"></script>

<!-- Create a div where the graph will take place -->
<div id="my_dataviz"></div>


<script>
// set the dimensions and margins of the graph
var margin = {top: 10, right: 30, bottom: 30, left: 60},
    width = 460 - margin.left - margin.right,
    height = 400 - margin.top - margin.bottom;

// append the svg object to the body of the page
var svg = d3.select("#my_dataviz")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

//Read the data
d3.csv("https://raw.githubusercontent.com/jdrodriguez777/Seminario/master/Nal_TD.csv",

  // When reading the csv, I must format variables:
  function(d){
    return { date : d3.timeParse("%Y-%m-%d")(d.date), value : d.value }
  },

  // Now I can use this dataset:
  function(data) {

    // Add X axis --> it is a date format
    var x = d3.scaleTime()
      .domain(d3.extent(data, function(d) { return d.date; }))
      .range([ 0, width ]);
    xAxis = svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

    // Add Y axis
    var y = d3.scaleLinear()
      .domain([0, d3.max(data, function(d) { return +d.value; })])
      .range([ height, 0 ]);
    yAxis = svg.append("g")
      .call(d3.axisLeft(y));

    // Add a clipPath: everything out of this area won't be drawn.
    var clip = svg.append("defs").append("svg:clipPath")
        .attr("id", "clip")
        .append("svg:rect")
        .attr("width", width )
        .attr("height", height )
        .attr("x", 0)
        .attr("y", 0);

    // Add brushing
    var brush = d3.brushX()                   // Add the brush feature using the d3.brush function
        .extent( [ [0,0], [width,height] ] )  // initialise the brush area: start at 0,0 and finishes at width,height: it means I select the whole graph area
        .on("end", updateChart)               // Each time the brush selection changes, trigger the 'updateChart' function

    // Create the area variable: where both the area and the brush take place
    var area = svg.append('g')
      .attr("clip-path", "url(#clip)")

    // Create an area generator
    var areaGenerator = d3.area()
      .x(function(d) { return x(d.date) })
      .y0(y(0))
      .y1(function(d) { return y(d.value) })

    // Add the area
    area.append("path")
      .datum(data)
      .attr("class", "myArea")  // I add the class myArea to be able to modify it later on.
      .attr("fill", "#69b3a2")
      .attr("fill-opacity", .3)
      .attr("stroke", "black")
      .attr("stroke-width", 1)
      .attr("d", areaGenerator )

    // Add the brushing
    area
      .append("g")
        .attr("class", "brush")
        .call(brush);

    // A function that set idleTimeOut to null
    var idleTimeout
    function idled() { idleTimeout = null; }

    // A function that update the chart for given boundaries
    function updateChart() {

      // What are the selected boundaries?
      extent = d3.event.selection

      // If no selection, back to initial coordinate. Otherwise, update X axis domain
      if(!extent){
        if (!idleTimeout) return idleTimeout = setTimeout(idled, 350); // This allows to wait a little bit
        x.domain([ 4,8])
      }else{
        x.domain([ x.invert(extent[0]), x.invert(extent[1]) ])
        area.select(".brush").call(brush.move, null) // This remove the grey brush area as soon as the selection has been done
      }

      // Update axis and area position
      xAxis.transition().duration(1000).call(d3.axisBottom(x))
      area
          .select('.myArea')
          .transition()
          .duration(1000)
          .attr("d", areaGenerator)
    }

    // If user double click, reinitialize the chart
    svg.on("dblclick",function(){
      x.domain(d3.extent(data, function(d) { return d.date; }))
      xAxis.transition().call(d3.axisBottom(x))
      area
        .select('.myArea')
        .transition()
        .attr("d", areaGenerator)
    });

})


</script>


</body>


